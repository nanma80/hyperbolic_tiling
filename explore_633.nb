(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    108610,       2741]
NotebookOptionsPosition[    100566,       2627]
NotebookOutlinePosition[    100969,       2643]
CellTagsIndexPosition[    100926,       2640]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\<C:\\\\Users\\\\nanma\\\\Documents\\\\GitHub\\\\hyperbolic_tiling\>\"",
    "]"}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"0bce0b81-aab1-4f44-8f72-78f0e03b3e8d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxExplosionFactor", "=", "10.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"frameCount", "=", "150"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"maxExplosionFactor", "=", "8.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"frameCount", "=", "6"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cellThreshold", "=", "10"}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"cellThreshold", "=", "40"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"argv", "=", 
   RowBox[{"Rest", "@", "$ScriptCommandLine"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "argv", "]"}], "<", "3"}], ",", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Usage: wolframscript.exe explode_honeycomb.wls <p> <q> <r> \
<cellThreshold>\>\"", "]"}], ";"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "argv", "]"}], ">=", "3"}], ",", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"argv", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
      RowBox[{"q", "=", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"argv", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
      RowBox[{"r", "=", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"argv", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"p", "=", "7"}], ";", 
      RowBox[{"q", "=", "3"}], ";", 
      RowBox[{"r", "=", "3"}], ";"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "argv", "]"}], ">=", "4"}], ",", 
     RowBox[{"cellThreshold", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"argv", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "]"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<{\>\"", "<>", 
    RowBox[{"IntegerString", "[", "p", "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"IntegerString", "[", "q", "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"IntegerString", "[", "r", "]"}], "<>", "\"\<}\>\""}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"shape", "=", 
    RowBox[{"\"\<explode_\>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"p", ",", "InputForm"}], "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"q", ",", "InputForm"}], "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"r", ",", "InputForm"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"dataFolder", "=", "\"\<data\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"imageFolder", "=", "\"\<images\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"epsilon", "=", "0.00000001"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"imageSize", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "3"}], "}"}], "/", "3"}], "*", "720"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"lighting", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\"\<Point\>\"", ",", "White", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"10", ",", 
         RowBox[{"-", "10"}], ",", "10"}], "}"}], "*", "5"}]}], "}"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rangeFactor", "=", "1.25"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"colors", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Red", ",", "Blue", ",", "Green", ",", "Yellow", ",", "Magenta", ",", 
        "LightCyan", ",", "Brown", ",", "Orange", ",", "Pink", ",", 
        RowBox[{"Darker", "[", 
         RowBox[{"Gray", ",", "0.2"}], "]"}], ",", "Cyan"}], "}"}], ",", 
      RowBox[{"RandomColor", "[", "80", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"outputFolder", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"imageFolder", ",", "\"\<explode_honeycombs\>\""}], "}"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"DirectoryQ", "[", "outputFolder", "]"}]}], ",", 
    RowBox[{"CreateDirectory", "[", "outputFolder", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"exportToPov", "=", "True"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"splitEdgeParts", "=", "15"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<POVRayRender`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ConfigurePOVRayRender", "[", 
    RowBox[{
    "\"\<POVRayPath\>\"", "->", 
     "\"\<C:\\\\Program \
Files\\\\POV-Ray\\\\v3.7\\\\bin\\\\pvengine64.exe\>\""}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Sqrt", "[", "5", "]"}]}], ")"}], "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"splitEdge", "[", 
    RowBox[{"edge_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"k", " ", 
         RowBox[{"edge", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "k"}], ")"}], " ", 
         RowBox[{"edge", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "+", 
           RowBox[{"1", "/", "n"}]}], ")"}], " ", 
         RowBox[{"edge", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "k", "-", 
           RowBox[{"1", "/", "n"}]}], ")"}], " ", 
         RowBox[{"edge", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", 
       RowBox[{"1", "-", 
        RowBox[{"1", "/", "n"}]}], ",", 
       RowBox[{"1", "/", "n"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"splitFaceToTriangles", "[", "face_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"face", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"face", "[", 
        RowBox[{"[", 
         RowBox[{"k", "-", "1"}], "]"}], "]"}], ",", 
       RowBox[{"face", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "3", ",", 
       RowBox[{"Length", "[", "face", "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HInner", "[", 
    RowBox[{"v_", ",", "u_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"2", "*", 
     RowBox[{"v", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "*", 
     RowBox[{"u", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "-", 
    RowBox[{"Dot", "[", 
     RowBox[{"v", ",", "u"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HNormSquare", "[", "v_", "]"}], ":=", 
   RowBox[{"HInner", "[", 
    RowBox[{"v", ",", "v"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HNorm", "[", "v_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"HNormSquare", "[", "v", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HNormalize", "[", 
    RowBox[{"v_", ",", "norm_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"v", "/", 
     RowBox[{"HNorm", "[", "v", "]"}]}], "*", "norm"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Rotation", "[", "t_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Cos", "[", "t", "]"}], ",", 
        RowBox[{"Sin", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "t", "]"}]}], ",", 
        RowBox[{"Cos", "[", "t", "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"cellCenterToOrigin", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"RotationMatrix", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Boost", "[", "boost_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cosh", "[", "boost", "]"}], ",", 
        RowBox[{"Sinh", "[", "boost", "]"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sinh", "[", "boost", "]"}], ",", 
        RowBox[{"Cosh", "[", "boost", "]"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HReflect", "[", 
    RowBox[{"point_", ",", "mirror_"}], "]"}], ":=", 
   RowBox[{"point", "-", 
    RowBox[{"2", "*", 
     RowBox[{
      RowBox[{"HInner", "[", 
       RowBox[{"point", ",", "mirror"}], "]"}], "/", 
      RowBox[{"HInner", "[", 
       RowBox[{"mirror", ",", "mirror"}], "]"}]}], "*", "mirror"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"centralReflect", "[", 
    RowBox[{"point_", ",", "mirror_"}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"HReflect", "[", 
     RowBox[{"point", ",", "mirror"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HDoubleReflect", "[", 
    RowBox[{"point_", ",", "mirror1_", ",", "mirror2_"}], "]"}], ":=", 
   RowBox[{"HReflect", "[", 
    RowBox[{
     RowBox[{"HReflect", "[", 
      RowBox[{"point", ",", "mirror1"}], "]"}], ",", "mirror2"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ApproxSamePoint", "[", 
    RowBox[{"point1_", ",", "point2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Round", "[", 
     RowBox[{"point1", ",", "epsilon"}], "]"}], "==", 
    RowBox[{"Round", "[", 
     RowBox[{"point2", ",", "epsilon"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxSamePointLoose", "[", 
     RowBox[{"point1_", ",", "point2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"point1", ",", 
       RowBox[{"10", " ", "epsilon"}]}], "]"}], "==", 
     RowBox[{"Round", "[", 
      RowBox[{"point2", ",", 
       RowBox[{"10", " ", "epsilon"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getEdgesFromFace", "[", "face_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"face", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"face", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ",", 
            RowBox[{"Length", "[", "face", "]"}]}], "]"}], "+", "1"}], "]"}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{
        RowBox[{"Length", "[", "face", "]"}], "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sameCenter", "[", 
    RowBox[{"set1_", ",", "set2_"}], "]"}], ":=", 
   RowBox[{"ApproxSamePoint", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"N", "[", "set1", "]"}], "]"}], ",", 
     RowBox[{"Mean", "[", 
      RowBox[{"N", "[", "set2", "]"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sameCellCenter", "[", 
    RowBox[{"cell1_", ",", "cell2_"}], "]"}], ":=", 
   RowBox[{"sameCenter", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"cell1", ",", "1"}], "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{"cell2", ",", "1"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getCellCenter", "[", "cell_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"cell", ",", "1"}], "]"}], "]"}], "/", 
    RowBox[{"Length", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"cell", ",", "1"}], "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getCellHeight", "[", "cell_", "]"}], ":=", 
   RowBox[{
    RowBox[{"getCellCenter", "[", "cell", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"opaqueFactor", "=", 
   RowBox[{"2", "/", "3"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getOpacityByExplosion", "[", "factor_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"factor", "<", 
       RowBox[{"maxExplosionFactor", "*", "opaqueFactor"}]}], ",", "1", ",", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "opaqueFactor"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", "opaqueFactor"}], ")"}]}], "/", 
         "maxExplosionFactor"}], "*", "factor"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getSplitEdges", "[", "edges_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "splitEdges", ",", "eid", ",", "edge", ",", "norm", ",", 
        "splitParts"}], "}"}], ",", 
      RowBox[{
       RowBox[{"splitEdges", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"eid", "=", "1"}], ",", 
         RowBox[{"eid", "<=", 
          RowBox[{"Length", "[", "edges", "]"}]}], ",", 
         RowBox[{"eid", "++"}], ",", 
         RowBox[{
          RowBox[{"edge", "=", 
           RowBox[{"edges", "[", 
            RowBox[{"[", "eid", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"norm", "=", 
           RowBox[{"HNorm", "[", 
            RowBox[{"edge", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"splitParts", "=", 
           RowBox[{"splitEdge", "[", 
            RowBox[{"edge", ",", "splitEdgeParts"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"splitParts", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"HNormalize", "[", 
               RowBox[{"#", ",", "norm"}], "]"}], "&"}], ",", "splitParts", 
             ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"splitEdges", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"splitEdges", ",", "splitParts"}], "]"}]}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "splitEdges"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getHyperboloid", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"v", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"v", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getKlein", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "/", 
    RowBox[{"v", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getPoincare", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getPoincareExploded", "[", 
    RowBox[{"v_", ",", "norm_"}], "]"}], ":=", 
   RowBox[{"norm", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "/", 
     RowBox[{"(", 
      RowBox[{"norm", "+", 
       RowBox[{"v", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"explodedCell", "[", 
     RowBox[{"cell_", ",", "explosionFactor_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "+", 
         RowBox[{
          RowBox[{"Mean", "[", 
           RowBox[{"Map", "[", 
            RowBox[{"Mean", ",", "cell"}], "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"HNorm", "[", 
              RowBox[{"First", "[", 
               RowBox[{"First", "[", "cell", "]"}], "]"}], "]"}], "/", 
             RowBox[{"HNorm", "[", 
              RowBox[{"Mean", "[", 
               RowBox[{"Map", "[", 
                RowBox[{"Mean", ",", "cell"}], "]"}], "]"}], "]"}]}], ")"}], 
           "^", "1.5"}], "*", "explosionFactor"}]}], ")"}], "&"}], ",", 
      "cell", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"explodeCellsByStep", "[", 
     RowBox[{
     "cells_", ",", "refCellCenters_", ",", "explosionFactor_", ",", 
      "explosionStep_", ",", "heightsMap_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"inactiveCells", ",", "activeCells"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"explosionStep", "==", "0"}], ",", 
         RowBox[{
          RowBox[{"inactiveCells", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"activeCells", "=", "cells"}]}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"explosionStep", "==", "2"}], ",", 
            RowBox[{
             RowBox[{"inactiveCells", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"cells", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"getCellCenter", "[", "#", "]"}], "}"}], ",", 
                    "refCellCenters", ",", 
                    RowBox[{"SameTest", "->", "ApproxSamePoint"}]}], "]"}], 
                   "]"}], ">", "0"}], "&"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"activeCells", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"cells", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"getCellCenter", "[", "#", "]"}], "}"}], ",", 
                    "refCellCenters", ",", 
                    RowBox[{"SameTest", "->", "ApproxSamePoint"}]}], "]"}], 
                   "]"}], "==", "0"}], "&"}]}], "]"}]}]}], ",", 
            RowBox[{"(*", 
             RowBox[{"explosionStep", "==", "1"}], "*)"}], 
            RowBox[{
             RowBox[{"inactiveCells", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"cells", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Norm", "[", 
                   RowBox[{
                    RowBox[{"getCellCenter", "[", "#", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", ",", "4"}], "]"}], "]"}], "]"}], "]"}], "<", 
                  "epsilon"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"activeCells", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"cells", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{
                    RowBox[{"getCellCenter", "[", "#", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", ",", "4"}], "]"}], "]"}], "]"}], "]"}], ">", 
                   "epsilon"}], "&&", 
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"getCellCenter", "[", "#", "]"}], "}"}], ",", 
                    "refCellCenters", ",", 
                    RowBox[{"SameTest", "->", "ApproxSamePoint"}]}], "]"}], 
                    "]"}], ">", "0"}]}], "&"}]}], "]"}]}]}]}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"inactiveCells", "=", 
              RowBox[{"{", "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"activeCells", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"cells", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"getCellCenter", "[", "#", "]"}], "}"}], ",", 
                    "refCellCenters", ",", 
                    RowBox[{"SameTest", "->", "ApproxSamePoint"}]}], "]"}], 
                   "]"}], ">", "0"}], "&"}]}], "]"}]}], ";"}], "*)"}], "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"acId", "=", "1"}], ",", 
         RowBox[{"acId", "<=", 
          RowBox[{"Length", "[", "activeCells", "]"}]}], ",", 
         RowBox[{"acId", "++"}], ",", 
         RowBox[{
          RowBox[{"cell", "=", 
           RowBox[{"activeCells", "[", 
            RowBox[{"[", "acId", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"height", "=", 
           RowBox[{"getCellHeight", "[", "cell", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"layer", "=", 
           RowBox[{"heightsMap", "[", 
            RowBox[{"Round", "[", 
             RowBox[{"height", ",", "epsilon"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nonlinearFactor", "=", 
           RowBox[{"getNonlinearFactor", "[", 
            RowBox[{"explosionFactor", ",", "layer"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", "\"\<{acId, nonlinearFactor, layer}\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"{", 
            RowBox[{"acId", ",", "nonlinearFactor", ",", "layer"}], "}"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"activeCells", "[", 
            RowBox[{"[", "acId", "]"}], "]"}], "=", 
           RowBox[{"explodedCell", "[", 
            RowBox[{"cell", ",", "nonlinearFactor"}], "]"}]}], ";"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"activeCells", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"explodedCell", "[", 
              RowBox[{"#", ",", "explosionFactor"}], "]"}], "&"}], ",", 
            "activeCells"}], "]"}]}], ";"}], "*)"}], 
       RowBox[{"{", 
        RowBox[{"activeCells", ",", "inactiveCells"}], "}"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"filterCells", "[", 
     RowBox[{"cells_", ",", "cellThreshold_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "cellCenterHeights", ",", "heightTally", ",", "tallyCounts", ",", 
        "includeCount", ",", "heightThreshold", ",", "levelIndex"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"cellCenterHeights", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"getCellHeight", ",", "cells"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"heightTally", "=", 
        RowBox[{
         RowBox[{"Tally", "[", 
          RowBox[{"cellCenterHeights", ",", "ApproxSamePoint"}], "]"}], "//", 
         "Sort"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tallyCounts", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", "heightTally"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "tallyCounts", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"includeCount", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"heightThreshold", "=", 
        RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"levelIndex", "=", "1"}], ",", 
         RowBox[{"levelIndex", "<=", 
          RowBox[{"Length", "[", "heightTally", "]"}]}], ",", 
         RowBox[{"levelIndex", "++"}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"includeCount", "<", "cellThreshold"}], ",", 
            RowBox[{
             RowBox[{"includeCount", "+=", 
              RowBox[{
               RowBox[{"heightTally", "[", 
                RowBox[{"[", "levelIndex", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"includeCount", ">=", "cellThreshold"}], ",", 
               RowBox[{"heightThreshold", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"heightTally", "[", 
                   RowBox[{"[", "levelIndex", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", "epsilon"}]}]}], "]"}],
              ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"heightThreshold", "==", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"heightThreshold", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"heightTally", "[", 
             RowBox[{"[", 
              RowBox[{"Length", "[", "heightTally", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "epsilon"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"filteredCells", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"cells", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"getCellCenter", "[", "#", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", "heightThreshold"}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Filter from \>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"Length", "[", "cells", "]"}], "]"}], "<>", 
         "\"\< cells down to \>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"Length", "[", "filteredCells", "]"}], "]"}], "<>", 
         "\"\< cells.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       "filteredCells"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getNonlinearFactor", "[", 
     RowBox[{"linear_", ",", "layer_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"layerOffset", ",", "linearOffset", ",", "returnValue"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"layerOffset", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"layer", ">", "1"}], ",", 
          RowBox[{"layer", "-", "1"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"linearOffset", "=", 
        RowBox[{"linear", "+", 
         RowBox[{"layerOffset", "*", "delayFactor"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"returnValue", "=", 
        RowBox[{
         RowBox[{"linearOffset", "^", "2"}], "/", "maxExplosionFactor"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"returnValue", ">", "maxExplosionFactor"}], ",", 
           RowBox[{"returnValue", "=", "maxExplosionFactor"}]}], "]"}], ";"}],
         "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"linearOffset", "<", "0"}], ",", 
         RowBox[{"returnValue", "=", "0"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "returnValue"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataFileName", "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"dataFolder", ",", 
       RowBox[{"\"\<hyper_\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"p", ",", "InputForm"}], "]"}], "<>", "\"\<_\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"q", ",", "InputForm"}], "]"}], "<>", "\"\<_\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"r", ",", "InputForm"}], "]"}], "<>", "\"\<_\>\"", "<>", 
        RowBox[{"IntegerString", "[", "cellThreshold", "]"}], "<>", 
        "\"\<.wl\>\""}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FileExistsQ", "[", "dataFileName", "]"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Reading from from \>\"", "<>", "dataFileName"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"Get", "[", "dataFileName", "]"}]}]}], ",", 
     RowBox[{"(*", 
      RowBox[{"file", " ", "do", " ", "not", " ", "exist"}], "*)"}], 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<data file \>\"", "<>", "dataFileName", "<>", 
        "\"\< does not exist\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", "\"\<cell threshold can only be 100, 300, or 1000\>\"", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Exit", "[", "]"}], ";"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"cells", "=", 
   RowBox[{"data", "[", "\"\<cells\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"cells", "//", "Length"}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"353", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "20", ",", "60", ",", "12", ",", "120"}], "}"}], " ",
       "1"}]}], ",", "21", ",", "81", ",", "93", ",", 
    RowBox[{
     RowBox[{"213", " ", "535"}], ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "12", ",", "60", ",", "120"}], "}"}], " ", "1"}]}], 
    ",", "13", ",", "73", ",", "193"}], "*)"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"newCellThreshold", "=", "cellThreshold"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"layers", "=", "1"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p", ",", "q", ",", "r"}], "}"}], "==", 
       RowBox[{"{", 
        RowBox[{"6", ",", "3", ",", "3"}], "}"}]}], "&&", 
      RowBox[{"cellThreshold", "==", "10"}], "&&", "False"}], ",", 
     RowBox[{"(*", 
      RowBox[{"1", "+", "20", "+", "60", "+", "12"}], "*)"}], 
     RowBox[{
      RowBox[{"newCellThreshold", "=", "4"}], ";", "\[IndentingNewLine]", 
      RowBox[{"layers", "=", "1"}], ";"}]}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "testing"}], ",", 
    RowBox[{"1", "+", "20"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"newCellThreshold", "=", "21"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellCenterHeights", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"getCellCenter", "[", "#", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "cells"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"heightTally", "=", 
   RowBox[{
    RowBox[{"Tally", "[", 
     RowBox[{"cellCenterHeights", ",", "ApproxSamePoint"}], "]"}], "//", 
    "Sort"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tallyCounts", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", "heightTally"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<heights\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "heightTally", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "tallyCounts", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"layers", "=", 
   RowBox[{"Length", "[", "tallyCounts", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Setting layers to: \>\"", "<>", 
     RowBox[{"IntegerString", "[", "layers", "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"delayFactor", "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"layers", ">=", "4"}], ",", "2", ",", "3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"cellCenters", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"getCellCenter", ",", "cells"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cellCenters", "=", 
   RowBox[{"Sort", "[", "cellCenters", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{"Print", ",", "cellCenters"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"HNorm", "[", "#", "]"}], "]"}], "&"}], ",", "cellCenters"}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Exit", "[", "]"}], ";"}], "*)"}]}], "\n"}], "Input",
 CellChangeTimes->{{3.862880128965761*^9, 3.862880128965761*^9}, {
  3.8628814543720713`*^9, 3.8628814544868507`*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"6493608d-0719-4be6-8d20-602c1b1f26c1"],

Cell[BoxData[
 TemplateBox[{
  "Rest", "norest", 
   "\"Cannot take Rest of expression \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) with length zero.\"", 2, 209, 7, 32054305050874129659, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8628801307770004`*^9, {3.862881432684472*^9, 3.862881457140873*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"1c8d1a0a-87bd-4ff0-b602-af4d4cb82d00"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Usage: wolframscript.exe explode_honeycomb.wls <p> <q> <r> \
<cellThreshold>\"\>"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457140873*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"de64f420-9591-4658-b3a6-aa4caa0eb078"],

Cell[BoxData["\<\"{7, 3, 3}\"\>"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457140873*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"7366fc52-5131-4114-885c-a044d332b44b"],

Cell[BoxData["\<\"Reading from from data\\\\hyper_7_3_3_10.wl\"\>"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814571573935`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"510b2535-e861-495b-8345-efff974bdaad"],

Cell[BoxData["20"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457173416*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"f7122417-5f34-4492-9e6f-de7110f08f5f"],

Cell[BoxData["\<\"heights\"\>"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457173416*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"7c5be66d-2f65-46a4-b5b7-407227a33d8c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3.0943237590286783`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6.141137472906436`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10.72052356793409`", ",", "12"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457173416*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"3e6d945a-29be-498f-9961-2b6ecf5c0d3c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "4", ",", "12"}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814571893883`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"852953a0-c7b0-4d3f-9e48-b482af71088b"],

Cell[BoxData["\<\"Setting layers to: 3\"\>"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814571893883`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"3c652846-c0b9-4e9b-931f-118c1e03c182"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.0943237590286783`", ",", 
   RowBox[{"-", "0.9533899982546167`"}], ",", 
   RowBox[{"-", "0.9533899982546167`"}], ",", 
   RowBox[{"-", "0.9533899982546166`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814571893883`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"0e83e33b-575d-4a7a-b088-d8b9134e07c2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.0943237590286783`", ",", 
   RowBox[{"-", "0.9533899982546167`"}], ",", "0.9533899982546162`", ",", 
   "0.9533899982546166`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814571893883`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"89d13910-6ba0-40f3-b4c3-72244bf25240"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.0943237590286783`", ",", "0.9533899982546159`", ",", 
   RowBox[{"-", "0.9533899982546166`"}], ",", "0.9533899982546166`"}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814571893883`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"2c3fb6de-9cfe-4431-ab36-e237d439a9a4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.0943237590286783`", ",", "0.9533899982546159`", ",", 
   "0.9533899982546162`", ",", 
   RowBox[{"-", "0.9533899982546162`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814571893883`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"4bdc58cc-ae97-4a16-9f78-8e25282c2c9c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.141137472906436`", ",", 
   RowBox[{"-", "3.2075737144952234`"}], ",", 
   RowBox[{"-", "3.2075737144952243`"}], ",", "3.207573714495223`"}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814571893883`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"b56758ff-275a-4ed3-96f8-b70b5a90ff9b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.141137472906436`", ",", 
   RowBox[{"-", "3.2075737144952234`"}], ",", "3.207573714495223`", ",", 
   RowBox[{"-", "3.207573714495223`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814571893883`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"01b07f0b-a017-4efd-addf-d447781057d2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.141137472906436`", ",", "3.207573714495221`", ",", 
   RowBox[{"-", "3.207573714495223`"}], ",", 
   RowBox[{"-", "3.207573714495223`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814571893883`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"c141f746-5022-42d5-bc59-e587dbce31cb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "6.141137472906436`", ",", "3.207573714495221`", ",", "3.207573714495221`", 
   ",", "3.207573714495221`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814571893883`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"3352b49c-46a1-4bc2-95b5-ce38020d0a0e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.72052356793409`", ",", 
   RowBox[{"-", "9.461536430131646`"}], ",", 
   RowBox[{"-", "3.0463890011412014`"}], ",", "3.046389001141202`"}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457205059*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"21581f09-988b-4fee-b44e-275687582d1d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.72052356793409`", ",", 
   RowBox[{"-", "9.461536430131646`"}], ",", "3.0463890011412005`", ",", 
   RowBox[{"-", "3.0463890011412005`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457205059*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"2b8486aa-825f-47c4-b293-7b312526e922"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.72052356793409`", ",", 
   RowBox[{"-", "3.0463890011412027`"}], ",", 
   RowBox[{"-", "9.461536430131645`"}], ",", "3.046389001141203`"}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457205059*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"b95510c0-ab41-40c0-9305-10569bb1848a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.72052356793409`", ",", 
   RowBox[{"-", "3.0463890011412027`"}], ",", 
   RowBox[{"-", "3.046389001141204`"}], ",", "9.461536430131643`"}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457205059*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"fac15209-f666-40ac-aba0-5a9da9fc38d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.72052356793409`", ",", 
   RowBox[{"-", "3.0463890011412027`"}], ",", "9.461536430131643`", ",", 
   RowBox[{"-", "3.0463890011412023`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457205059*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"7d08aba0-af13-4cce-866e-ca703bbc1ffd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.72052356793409`", ",", 
   RowBox[{"-", "3.0463890011412023`"}], ",", "3.0463890011411996`", ",", 
   RowBox[{"-", "9.461536430131643`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457205059*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"0a953201-ca18-469f-8822-9f8eff033874"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.72052356793409`", ",", "3.0463890011411987`", ",", 
   RowBox[{"-", "9.461536430131645`"}], ",", 
   RowBox[{"-", "3.0463890011412005`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457205059*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"6ac82c60-0391-4554-b28f-c3b730ca7f5e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10.72052356793409`", ",", "3.0463890011411987`", ",", 
   "3.0463890011411987`", ",", "9.461536430131643`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457205059*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"0c571b5a-a45e-4942-99ea-e1bbfe9be722"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.72052356793409`", ",", "3.0463890011412014`", ",", 
   RowBox[{"-", "3.0463890011412014`"}], ",", 
   RowBox[{"-", "9.461536430131643`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457205059*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"60ada4b6-f786-4058-ae5f-c21816367215"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10.72052356793409`", ",", "3.0463890011412014`", ",", "9.461536430131641`",
    ",", "3.046389001141199`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457205059*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"2e9a164f-74f9-4212-a43b-36abff8ccbc6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.72052356793409`", ",", "9.461536430131641`", ",", 
   RowBox[{"-", "3.0463890011412`"}], ",", 
   RowBox[{"-", "3.0463890011412005`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572206917`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"7fb8783c-e6a8-4ce7-b471-d855b88646ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10.72052356793409`", ",", "9.461536430131641`", ",", "3.0463890011412014`",
    ",", "3.0463890011412014`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572206917`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"03a0ee3a-2456-4f5c-ae7d-c0711ad6505a"],

Cell[BoxData["2.6168649295241733`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572206917`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"62a86988-9ddd-4fa6-ae7f-f0fe2bc15ffb"],

Cell[BoxData["2.6168649295241733`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572206917`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"f194fda0-df3b-4835-880b-b76306a56d84"],

Cell[BoxData["2.6168649295241737`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572206917`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"37551f2f-ce9c-426c-8020-0e57f2056b2e"],

Cell[BoxData["2.6168649295241737`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572206917`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"8a9695de-5287-4aa6-baa0-efd38b376364"],

Cell[BoxData["2.61686492952418`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457230708*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"e3fcb4f5-9b5b-4154-b65d-f630cd148862"],

Cell[BoxData["2.616864929524183`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457230708*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"bda59559-c4fa-4e59-8c5d-16791334c27a"],

Cell[BoxData["2.616864929524183`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457230708*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"92970498-9e1d-43a8-8b52-dc3b43dd8959"],

Cell[BoxData["2.6168649295241884`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457230708*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"977c83d8-057f-4b5d-81e4-81379a39bd26"],

Cell[BoxData["2.61686492952421`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.862881457230708*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"d1f06e67-f3bd-4519-9b32-6e4738470fa8"],

Cell[BoxData["2.616864929524221`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572367597`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"834a2548-8787-4e88-a9bf-a8db2a72aea0"],

Cell[BoxData["2.6168649295242155`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572367597`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"96da6c08-28b1-4e1a-a9cc-c4c88f786f6d"],

Cell[BoxData["2.616864929524221`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572367597`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"dfd221bb-fbfb-4164-9f79-df5bb83bab46"],

Cell[BoxData["2.616864929524226`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572367597`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"3d3bf63c-cec6-435b-9c13-64a58cf9d694"],

Cell[BoxData["2.616864929524226`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572367597`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"f67a5b8f-411b-41c3-947d-ea2b4ee0f0e5"],

Cell[BoxData["2.616864929524232`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572367597`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"f51cabd1-57ac-48b6-9b77-9c32f3a50948"],

Cell[BoxData["2.616864929524232`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572367597`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"8ab05c87-670f-4d19-8270-931571df71dd"],

Cell[BoxData["2.616864929524226`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572367597`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"4f416bd7-6b9b-4df8-abb1-741b50f80fcf"],

Cell[BoxData["2.616864929524237`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572367597`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"5091f19b-a2ee-492d-ac41-a6b1d27ba35d"],

Cell[BoxData["2.616864929524237`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572367597`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"4f041dfc-f586-4f8c-8577-2f4bdc2a078b"],

Cell[BoxData["2.616864929524226`"], "Print",
 CellChangeTimes->{
  3.8628801307925987`*^9, {3.8628814326907487`*^9, 3.8628814572367597`*^9}},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"621fa5c0-f0ec-442f-8791-5a0a689b26f9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getNonCompactCellCenter", "[", "cell_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "samplePoints", ",", "face1Points", ",", "face2id", ",", 
       "centerSolution"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"face1Points", "=", 
       RowBox[{
        RowBox[{"cell", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"Range", "[", "3", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"face2id", "=", "1"}], ",", 
        RowBox[{"face2id", "<=", 
         RowBox[{"Length", "[", 
          RowBox[{"cell", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"face2id", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"samplePoints", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"face1Points", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cell", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "face2id", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"Det", "[", "samplePoints", "]"}], "]"}], ">", 
            "epsilon"}], ",", 
           RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Det", "[", "samplePoints", "]"}], "]"}], "<=", "epsilon"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Cannot construct samplePoints\>\"", "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"centerSolution", "=", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"HInner", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"w", ",", "x", ",", "y", ",", "z"}], "}"}], ",", 
             RowBox[{"samplePoints", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "==", 
           RowBox[{"HInner", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"w", ",", "x", ",", "y", ",", "z"}], "}"}], ",", 
             RowBox[{"samplePoints", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"HInner", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"w", ",", "x", ",", "y", ",", "z"}], "}"}], ",", 
             RowBox[{"samplePoints", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "==", 
           RowBox[{"HInner", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"w", ",", "x", ",", "y", ",", "z"}], "}"}], ",", 
             RowBox[{"samplePoints", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"HInner", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"w", ",", "x", ",", "y", ",", "z"}], "}"}], ",", 
             RowBox[{"samplePoints", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "==", 
           RowBox[{"HInner", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"w", ",", "x", ",", "y", ",", "z"}], "}"}], ",", 
             RowBox[{"samplePoints", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "&&", 
          RowBox[{"w", "==", "1"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"w", ",", "x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w", ",", "x", ",", "y", ",", "z"}], "}"}], "/.", 
       RowBox[{"centerSolution", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"centers", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"getNonCompactCellCenter", "[", 
     RowBox[{"cells", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "cells", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8628809532308197`*^9, 3.8628813693966475`*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"5a36e93a-f416-42cd-8255-0b873ffc9035"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.`", ",", 
     RowBox[{"-", "0.7322375113586903`"}], ",", 
     RowBox[{"-", "0.7322375113586903`"}], ",", 
     RowBox[{"-", "0.7322375113586909`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", 
     RowBox[{"-", "0.7322375113586903`"}], ",", "0.7322375113586913`", ",", 
     "0.7322375113586909`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.7322375113586921`", ",", 
     RowBox[{"-", "0.7322375113586908`"}], ",", "0.7322375113586911`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.7322375113586923`", ",", "0.7322375113586911`", ",", 
     RowBox[{"-", "0.732237511358691`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", 
     RowBox[{"-", "0.6002770825839987`"}], ",", 
     RowBox[{"-", "0.6002770825839973`"}], ",", "0.6002770825839983`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", 
     RowBox[{"-", "0.6002770825839984`"}], ",", "0.6002770825839981`", ",", 
     RowBox[{"-", "0.6002770825839977`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.6002770825839976`", ",", 
     RowBox[{"-", "0.6002770825839978`"}], ",", 
     RowBox[{"-", "0.6002770825839981`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.6002770825839978`", ",", "0.6002770825839983`", ",", 
     "0.6002770825839985`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", 
     RowBox[{"-", "0.9385645236010336`"}], ",", 
     RowBox[{"-", "0.2686249231541729`"}], ",", "0.26862492315418`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", 
     RowBox[{"-", "0.9385645236010332`"}], ",", "0.2686249231541809`", ",", 
     RowBox[{"-", "0.2686249231541731`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", 
     RowBox[{"-", "0.2686249231541751`"}], ",", 
     RowBox[{"-", "0.9385645236010359`"}], ",", "0.26862492315417663`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", 
     RowBox[{"-", "0.2686249231541759`"}], ",", 
     RowBox[{"-", "0.26862492315417613`"}], ",", "0.9385645236010364`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", 
     RowBox[{"-", "0.2686249231541734`"}], ",", "0.26862492315417985`", ",", 
     RowBox[{"-", "0.9385645236010336`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", 
     RowBox[{"-", "0.26862492315417774`"}], ",", "0.9385645236010374`", ",", 
     RowBox[{"-", "0.26862492315417424`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.2686249231541805`", ",", 
     RowBox[{"-", "0.9385645236010332`"}], ",", 
     RowBox[{"-", "0.2686249231541744`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.26862492315418113`", ",", "0.26862492315417386`", ",", 
     "0.938564523601033`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.2686249231541743`", ",", 
     RowBox[{"-", "0.26862492315417735`"}], ",", 
     RowBox[{"-", "0.9385645236010376`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.268624923154173`", ",", "0.9385645236010384`", ",", 
     "0.26862492315417763`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.9385645236010361`", ",", 
     RowBox[{"-", "0.2686249231541734`"}], ",", 
     RowBox[{"-", "0.2686249231541756`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9385645236010366`", ",", "0.268624923154175`", ",", 
     "0.2686249231541732`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.862881323651517*^9, 3.8628813700005302`*^9}, {
  3.862881437002776*^9, 3.862881463572362*^9}},
 CellLabel->
  "Out[280]=",ExpressionUUID->"4f088692-22e5-4d6c-9e8a-3a9a81607445"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxExplosionFactor", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"layers", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delayFactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameCount", "=", "10"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8631115564440775`*^9, 3.8631115809187584`*^9}, {
  3.863114462728735*^9, 3.8631144628495736`*^9}, {3.863202610322962*^9, 
  3.863202611227359*^9}, {3.8632027202914605`*^9, 3.8632027224519815`*^9}, {
  3.863202784251659*^9, 3.863202784511018*^9}, {3.8632029031504574`*^9, 
  3.8632029032304654`*^9}, {3.8632029493203974`*^9, 3.863202949400832*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"82bc45dc-7ccb-4f68-a82a-aa50d8ba7faa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"explosionFactors", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"k", "*", "1.0"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "maxExplosionFactor", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "layers"}], "+", "1"}], ")"}], "*", "delayFactor"}], 
         ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"maxExplosionFactor", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"layers", "-", "1"}], ")"}], "*", "delayFactor"}]}], 
            ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"frameCount", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "explosionFactors", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getNonlinearFactor", "[", 
        RowBox[{"linear", ",", "layer"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"layer", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"linear", ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "delayFactor"}], ",", "maxExplosionFactor"}],
       "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.863202533121642*^9, 3.863202533122798*^9}, {
   3.8632026172858067`*^9, 3.8632027723715487`*^9}, {3.8632028136561756`*^9, 
   3.8632028221112423`*^9}, {3.863202852240985*^9, 3.863202872640785*^9}, 
   3.863203307871383*^9},ExpressionUUID->"7afdaa10-235c-443c-814e-\
689d86867b16"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "500.`", ",", "471.57894736842104`", ",", "443.1578947368421`", ",", 
   "414.7368421052632`", ",", "386.3157894736842`", ",", 
   "357.89473684210526`", ",", "329.4736842105263`", ",", 
   "301.05263157894734`", ",", "272.63157894736844`", ",", 
   "244.21052631578948`", ",", "215.78947368421052`", ",", 
   "187.3684210526316`", ",", "158.94736842105263`", ",", 
   "130.52631578947367`", ",", "102.10526315789474`", ",", 
   "73.6842105263158`", ",", "45.26315789473684`", ",", "16.842105263157894`",
    ",", 
   RowBox[{"-", "11.578947368421053`"}], ",", 
   RowBox[{"-", "40.`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.863202618166189*^9, 3.863202649951636*^9, {3.8632027076613016`*^9, 
   3.8632027861312785`*^9}, 3.8632028229307847`*^9, {3.863202855460721*^9, 
   3.863202873150529*^9}, 3.863202904861446*^9, 3.8632032942072706`*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"e48be8b9-b32f-434c-826b-ee7e18f945ad"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1: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

       "]], LineBox[CompressedData["
1:eJxF0Xc81fsfwHEyrh3HyizHKnscOz7vyEhGGac6rpKVvWfinG5udIyQNDjW
qXAvLRmFn69RCmVkXZuEokJIJefn/uP+8X68H8/H4/XH+/F4y7gHO3jtYmJi
om/Pv5s6nEZnMMywzbLlXlv3EDSL69gsOnVox5dy+MuTvY133OfVQJVIMtyx
nI6f7/0SvR135mFD3/R0dxzBKmp16CVhx1b6zQwv/v8sGRBYQz2pvWN2djNB
2qbWjpcK9gQ/KPzP7wNYaLVhWthYNMXl2rNwNGzwub3psBZWeRNtjaTHoC72
fzbaRbSwlhGivMvHeNT6tkWhb14Tu7zPwyd59iLipIiLfWjQxBbb5x8yphOR
nUoo91aWJhal6+rpI56Mrg21/cL5aGLyHtgfzakpaChReknRWBP7fgzHw2d4
FUlpRk4fxGliG+QDFPnMTOQ+1tF3fE4DY9dvelBffA0t6sQ+jcvUwIZfEdWd
pW8izemuvzO8NbBCuhOZmHwbRaUr5N810sC+jb1K7N5NQ4zXJWwFHeqYtiHv
yRtGRUhBw/WmRYQaxiOk1PrKsQQ9TOaKD5FWw/QvsZtWbJUiw6mas7dfqmL3
i/PFbWv/QnZZOOXPkqpYxArzaNOJ+yhyta3h+nNl7Jlfe1ejbCXasoksbgxW
xmI8Sr7jCU9Q8l180gcxZewEYfrYzNEqlEeMP2YcpIQlng5NuphZg1prtd7N
iBzArvetCSlE1iM7gck2vqb9WER6U9l5rAEN+aaV6/vvx2L2LfirCjaiRfH5
yNRGRSx6VrmeOIchwXgaB8FHAeugdwxxd7WgvH7rT644Bcx+qnRILasVKaht
9CTVy2PvuHS+MJ16jgwnHHJH+OUxMzzJ7fHyC+R+iEPt0lNZbOzsoIO1fTta
vFWFq/CQxVYYyhyz6h0oasX92wCvLCZGVe/TEOpEVHoDpuSOx2juZg/fzr1G
j9jCHXu5ZDBTnP3BkrFuxJxdt2xaK4mNr+2WT+XsRwmGjJ7V3ZKYXNx7vcvZ
/Whz0vTxvXMSGME0L9FcZgCtq7aHcYmKY0+vV3QIwiBabBv62hMpitk5nOH/
kvUPGvi5tuamjcOKZBjhhWnjyLHYYACXIoAVtMzLfSZMoG6r+OrWaX7Mr6Ry
N/P4BMpR5vx8TG43pn476kjd7UlEOaOwNDHFiS0++qbYvTmFStOb5n8+3WqM
5dnjEL0wg2j7u31b9mw2vl3I+W5p+x5lNY9/pEZ/bxQOYDf5+eA9urD+c1FM
Z7XRyr6Gxhkzi4rrA6aD3d41Rha61T7HzSOeO2U8eypn0XRgD6kubAGRblX9
uFLNBdRhYSW7oGU0S4n6ViHLAy0Fd1n+93gZhfrorfZk8ALllrBm5bdl1Jo7
up6qww+pSjlJqpdW0LDf6aW+3YKw0Cwm6174FXFwur/zbN0D/+tUEur4uoYe
FT/xbBbBQ/XhiPHcrR8oe3TGgzsMD6W3uQjVjj9RlIiwh9NrPEjLXxxzLvuJ
DlIjz85ekgXaIJ+KPHETvQzVPc21LAcTj8trWKp/oXGoPeHQoQhGMrGH3SyZ
gHuiznqarAoM994rkg4sYEcSahLsVwUbf/O0GxdZIKM/QM9cSQ0kaWOFNo9Y
QKRTSq60Tw0c4+M3PAVYIXO0cataSAPYNOJ87fpYgfZKZuiCryaknw5yYPVi
hyr6eyqHIAHwk9qw+YgTiFMCFkXGBFAXs7F6Os8JG9ImzIY+BGiOu+L2cC8X
GN7OifZvIEB0Q3iTTToXYBmWnm/O6YCqNru5SRA3dMaXGWfX60LtHN6R1YAX
Zk4ELu31NoCyZzRzvnh+EMkzpR/JNoDUVe2Eknx+sJoUJYY3G8BvKn5d7hg/
VPg0172QNoRX16rrEKsARMWKJgUOGkKYRVddVpoAcOQ2SdVZHYQz+kwk2j0c
KI8LHyUqI7hn58ZnviIEBloTDhYxpjB1WOzE+BcxuFMV4Psl3RQKX7/C9MXE
gd/gB/nmXVNw1Sv+7YmpOMwj4YqPvabQVdGuwpsjDjdtj/52VdUMkhR+9B0x
kYANn5q6wWkzIFq+zVvMloTqgqtyvrbm4GYRxDVE2gvavLCegrcCaRpdjX4H
Dxpbcjyn/G3B4cRaz5PR/VDkdj0Ff+04fAjx6O200wAVW5L1KHKCyzMirQ+8
CcDvGVchNUEEiYzjsvUj+sA0o5ISVHMKSFcsP2pqmsBy0D48y5nfQfm04OeQ
nkPw2f2Odgk6A+xZLl4MNnMohuYIX86zEGZ2tTUp0ArsnB1VikjuIN7I6DLu
PwqUfJUit5ce8PyuDdvPF/ag9eneSpOUF2DPeRbfDx0HvxBf5r+vesMzjako
MTEn6OIgTQ/+OAfhHeqfREKIUHVvoeCerS+Eidol5defhH2xz8V/1fuBs73q
SxkXF+A5DmFrggHQ393Dkb/gCvImH3I1PQPB7Z/A9UlzN2g9M/zHWncQTJ7l
sghr/vdOXXoFLgRWBbNbbxA84HAo3UOuIwT6jAtOSg94QkWZIq8xJRS4iXOX
syjeMOC5eUfhQBhcIv6ZKCXlA6aGkRJOk2EwEt3gULDoC0FZJhSHlHDYFZpJ
Dyn3B8016TcrWhGQp6e2VhgaCHph9B8D8xEwGswtbhkYDL9CY4RTsyIB1vTC
F/4KAfbUZb4/raOA2aVPdLwuFLr2163brUeB7qnyabfmMFDvzm17lh8NffoR
43Pt4dCbuS/azzkG8OVj8iPLEaAzsCa0wIiBFUeP0jKeKBghBGc+qI2FwwLy
a86W0SCaz1gXDjoPi8tG168lxoAQddLaVjQOJLCtX4uVseCY4RX/8k0ctPXe
HfjCGgeOYkb5QucvwCcXkUAlywvwoVyxdBc+HuzFRQ+pUeOhmVSbQRiKB/Z9
/m9ylxLAJeXWOb0/EiCnv/yJhSwFxBc7r6j9mQAbWfJEawUKDNswlcsnJ4C7
VwmyO0ABEt+5JcH0BDh25MVHovq2MwmxS7cSgMobWuRvRIGTN7qoZY8SIC7p
fEaxIwWIdLb7ElMJ8Psh10iLRAqIsBp042YSoLFgQ9QxibL9n4AVzrkEOCBI
2+VG3e4V3upuLCaAsAHzw/MZFHAuK2zs20gA64u6/pV5FHB6YNSTxk8GfRZn
D60qCgjxB39NFCSDxOOLl81qKdAXUix8QYQMrFE1y051FHDU4iT5SZJh6aBJ
YUwTBRyqBqYt9pNBrq3WteU1BXAiXGwmymSwkFZrGuimQG+UsaKOGhmCqeUB
H99u9/p3/GUJZBguas3FDW/3twbTxPXIIGl7eq/i2Hb/neuhgCEZvHiZF4wm
KZBFMunlMCZD9XT51rF3FDheF7rKQGTgfX2W5D1Lgf8Dtt3JGw==
       "]], LineBox[CompressedData["
1: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
       "]]},
     Annotation[#, "Charting`Private`Tag$35579#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-40, 500}, {0., 583.1999761959185}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.863202618166189*^9, 3.863202649951636*^9, {3.8632027076613016`*^9, 
   3.8632027861312785`*^9}, 3.8632028229307847`*^9, {3.863202855460721*^9, 
   3.863202873150529*^9}, 3.863202904861446*^9, 3.8632032942467055`*^9},
 CellLabel->
  "Out[136]=",ExpressionUUID->"ec4aa597-3af5-4c43-bfa2-2bd391526196"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"explosionFactors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"k", "*", "1.0"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "maxExplosionFactor", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "layers"}], "+", "1"}], ")"}], "*", "delayFactor"}], 
       ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"maxExplosionFactor", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"layers", "-", "1"}], ")"}], "*", "delayFactor"}]}], 
          ")"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"frameCount", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "explosionFactors", "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "explosionFactors", "]"}]}], "Input",
 CellChangeTimes->{{3.8631115514327765`*^9, 3.8631115531886835`*^9}, {
  3.8631115867753253`*^9, 3.863111588570462*^9}, {3.8631116888681335`*^9, 
  3.863111689188815*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"8a0c39aa-a480-4893-8c7f-42ab459a4614"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "100.`", ",", "88.55555555555556`", ",", "77.11111111111111`", ",", 
   "65.66666666666667`", ",", "54.22222222222222`", ",", "42.77777777777778`",
    ",", "31.333333333333332`", ",", "19.88888888888889`", ",", 
   "8.444444444444445`", ",", 
   RowBox[{"-", "3.`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8631115891672072`*^9, 3.863111689575815*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"ae88e1cc-a6c5-4ce1-a063-829396d26ce2"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    PointBox[{{1., 100.}, {2., 88.55555555555556}, {3., 77.11111111111111}, {
     4., 65.66666666666667}, {5., 54.22222222222222}, {6., 
     42.77777777777778}, {7., 31.333333333333332`}, {8., 19.88888888888889}, {
     9., 8.444444444444445}, {10., -3.}}]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 10}, {-3., 100.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.8631115891672072`*^9, 3.86311168959188*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"c8a4a856-3db4-488b-ae76-828d87c0f345"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Exp", "[", "x", "]"}], "-", "1"}], ")"}], "/", "2"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "layers"}], "+", "1"}], ")"}], "*", "delayFactor"}]}], "/.", 
  RowBox[{"x", "->", "5."}]}]], "Input",
 CellChangeTimes->{{3.863111825258528*^9, 3.863111844506426*^9}, {
  3.863111877282998*^9, 3.8631119140221953`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"1476f101-ead2-4862-acef-1b89af42b39a"],

Cell[BoxData["70.7065795512883`"], "Output",
 CellChangeTimes->{{3.863111827243655*^9, 3.863111844740981*^9}, {
  3.8631118778207684`*^9, 3.8631119144163113`*^9}},
 CellLabel->"Out[24]=",ExpressionUUID->"38c3a15e-52ff-4c25-ab82-4fa456aaaef6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "-", "1"}], ")"}], "/", "2"}], ",", "x"}], 
   "]"}], "/.", 
  RowBox[{"x", "->", "1"}]}]], "Input",
 CellChangeTimes->{{3.863111989843485*^9, 3.8631120554630938`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"c64275ac-c231-48af-9b5d-35592b8e51d9"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.8631119917615533`*^9, 3.863112015495911*^9}, {
  3.8631120475645523`*^9, 3.8631120557979574`*^9}},
 CellLabel->"Out[35]=",ExpressionUUID->"ee665eda-2254-4b2d-82c4-6764c82ceb40"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxExplosionFactor", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"layers", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delayFactor", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameCount", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kExponent", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getNonlinearFactor", "[", 
    RowBox[{"linear_", ",", "layer_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"layerOffset", ",", "linearOffset", ",", "returnValue"}], "}"}],
      ",", 
     RowBox[{
      RowBox[{"minFactor", "=", "0.004"}], ";", "\[IndentingNewLine]", 
      RowBox[{"layerOffset", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"layer", ">", "1"}], ",", 
         RowBox[{"layer", "-", "1"}], ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"linearOffset", "=", 
       RowBox[{"linear", "+", 
        RowBox[{"layerOffset", "*", "delayFactor"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"returnValue", "=", 
       RowBox[{
        RowBox[{"linearOffset", "^", "2"}], "/", "maxExplosionFactor"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"returnValue", ">", "maxExplosionFactor"}], ",", 
          RowBox[{"returnValue", "=", "maxExplosionFactor"}]}], "]"}], ";"}], 
       "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"linearOffset", "<", "0"}], "||", 
         RowBox[{"returnValue", "<", "minFactor"}]}], ",", 
        RowBox[{"returnValue", "=", "minFactor"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "returnValue"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxk", "=", 
   RowBox[{"maxExplosionFactor", "^", 
    RowBox[{"(", 
     RowBox[{"1", "/", "kExponent"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"explosionFactors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k", "^", "kExponent"}], "-", "1."}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "layers"}], "+", "1"}], ")"}], "*", "delayFactor"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "maxk", ",", "1", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"maxk", "-", "1"}], ")"}]}], "/", "frameCount"}]}], "}"}]}],
     "]"}]}], 
  ";"}], "\[IndentingNewLine]", "explosionFactors", "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"getNonlinearFactor", "[", 
    RowBox[{
     RowBox[{"explosionFactors", "[", 
      RowBox[{"[", "fid", "]"}], "]"}], ",", "layer"}], " ", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"layer", ",", "layers"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"fid", ",", 
     RowBox[{"Length", "[", "explosionFactors", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"getNonlinearFactor", "[", 
     RowBox[{
      RowBox[{"explosionFactors", "[", 
       RowBox[{"[", "fid", "]"}], "]"}], ",", "layer"}], " ", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"layer", ",", "layers"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"fid", ",", 
      RowBox[{"Length", "[", "explosionFactors", "]"}]}], "}"}]}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8631122829963655`*^9, 3.8631123253038836`*^9}, {
  3.8631123650417385`*^9, 3.863112382281597*^9}, {3.863112451422631*^9, 
  3.863112477285655*^9}, {3.863114514543505*^9, 3.8631145576902742`*^9}, {
  3.863114588693228*^9, 3.863114588802909*^9}, {3.863115862715292*^9, 
  3.863115888087882*^9}, {3.8632029342805676`*^9, 3.86320293863068*^9}, {
  3.86320298400062*^9, 3.863203062824685*^9}, {3.8632033143604455`*^9, 
  3.8632034447401705`*^9}, {3.8632034828131723`*^9, 3.8632035395527935`*^9}, {
  3.8632036895976496`*^9, 3.8632038650364494`*^9}},
 CellLabel->
  "In[384]:=",ExpressionUUID->"952e5e94-246d-4862-891c-1f49ebc8ae4e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "439.`", ",", "364.68935882862263`", ",", "298.9867984279539`", ",", 
   "241.20038560799662`", ",", "190.66718228991766`", ",", 
   "146.7532455060476`", ",", "108.8536273998813`", ",", "76.39237522607772`",
    ",", "48.82253135045961`", ",", "25.626133250014135`", ",", 
   "6.31421351289228`", ",", 
   RowBox[{"-", "9.573200161590869`"}], ",", 
   RowBox[{"-", "22.46708496295617`"}], ",", 
   RowBox[{"-", "32.76942296956041`"}], ",", 
   RowBox[{"-", "40.85320114859634`"}], ",", 
   RowBox[{"-", "47.06241135609267`"}], ",", 
   RowBox[{"-", "51.712050336913975`"}], ",", 
   RowBox[{"-", "55.08811972476087`"}], ",", 
   RowBox[{"-", "57.44762604216987`"}], ",", 
   RowBox[{"-", "59.01858070051344`"}], ",", 
   RowBox[{"-", "60.`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8631123193793297`*^9, 3.8631123262043576`*^9}, {
   3.8631123786992965`*^9, 3.863112382514135*^9}, 3.863112478079895*^9, {
   3.8631145094396667`*^9, 3.8631145580864925`*^9}, 3.8631145892323303`*^9, {
   3.8631158576435876`*^9, 3.863115888610879*^9}, {3.863202926770657*^9, 
   3.8632030632000113`*^9}, {3.8632033153910594`*^9, 3.8632033970552807`*^9}, 
   3.8632034453106537`*^9, {3.863203483553603*^9, 3.8632035398327484`*^9}, {
   3.8632036900673504`*^9, 3.8632038653165855`*^9}},
 CellLabel->
  "Out[392]=",ExpressionUUID->"605387a4-2633-4b7e-8621-0f4f2edfe796"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "385.442`", ",", "265.99665688566375`", ",", "178.78621126839585`", ",", 
     "116.35525203489253`", ",", "72.70794880475339`", ",", 
     "43.07303013311655`", ",", "23.698224396224383`", ",", 
     "11.671589985363706`", ",", "4.767279134933224`", ",", 
     "1.31339741069496`", ",", "0.07973858457278295`", ",", "0.004`", ",", 
     "0.004`", ",", "0.004`", ",", "0.004`", ",", "0.004`", ",", "0.004`", 
     ",", "0.004`", ",", "0.004`", ",", "0.004`", ",", "0.004`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "439.922`", ",", "311.5593799450985`", ",", "216.46462707975033`", ",", 
     "147.09929830785214`", ",", "97.3880106795435`", ",", 
     "62.483419593842264`", ",", "38.56065968421014`", ",", 
     "22.638675012493035`", ",", "12.425982896988376`", ",", 
     "6.188533400696656`", ",", "2.6374442061198566`", ",", 
     "0.8345083032768627`", ",", "0.11348961791064205`", ",", "0.004`", ",", 
     "0.004`", ",", "0.004`", ",", "0.004`", ",", "0.004`", ",", "0.004`", 
     ",", "0.004`", ",", "0.004`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "498.002`", ",", "360.72210300453315`", ",", "257.7430428911048`", ",", 
     "181.44334458081173`", ",", "125.66807255433362`", ",", 
     "85.49380905456798`", ",", "57.02309497219589`", ",", 
     "37.205760039622355`", ",", "23.684686659043532`", ",", 
     "14.663669390698352`", ",", "8.79514982766693`", ",", 
     "5.085724283885958`", ",", "2.8174394223559016`", ",", 
     "1.4830086508214086`", ",", "0.733199812512225`", ",", 
     "0.33476239983791994`", ",", "0.13738021923569552`", ",", 
     "0.04825313567656642`", ",", "0.013029225641218858`", ",", "0.004`", ",",
      "0.004`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8631123193793297`*^9, 3.8631123262043576`*^9}, {
   3.8631123786992965`*^9, 3.863112382514135*^9}, 3.863112478079895*^9, {
   3.8631145094396667`*^9, 3.8631145580864925`*^9}, 3.8631145892323303`*^9, {
   3.8631158576435876`*^9, 3.863115888610879*^9}, {3.863202926770657*^9, 
   3.8632030632000113`*^9}, {3.8632033153910594`*^9, 3.8632033970552807`*^9}, 
   3.8632034453106537`*^9, {3.863203483553603*^9, 3.8632035398327484`*^9}, {
   3.8632036900673504`*^9, 3.863203865321864*^9}},
 CellLabel->
  "Out[393]=",ExpressionUUID->"61e1fd86-1417-4026-9732-a51a4cc4082f"],

Cell[BoxData[
 GraphicsBox[{{}, {
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQEf7AN6p+cJiVc4QAUcVKfU+n2aXwDlczhYbOhY
ohGZBuULONx+w168RywWyhdxkHvVwOGvGwTlSzhcX6vBG9npCuXLOEzjbb66
b5M5lK/gMO9V3ZJb4epQvpLDt8Oy8zcKCkP5Kg5/4m8yrGX+ag/hqzkc1PlR
sj9zC5Sv4fBn5cdLvkkFUL4WGl8Hja+HxjdA4xui8Y3Q+MZofBM0vimcDwDJ
pmHg
      "]]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQEf7GfkCTUfqKt2gAo4nFicZPG5ohjK53BYzD3H
8h5fNpQv4LBXYmmxbnISlC/icO3EPq2rERFQvoSD5rOKjQ9s/aF8GQel9/6b
Drs7Q/kKDsJ5i00aFptB+UoOtwrU8qRuaUD5Kg4NJyKe8R2UgPLVHE5VCkXW
SLJC+RoO/wVuHfTa8soewtdysJgdc3U5714oX8fhz8qPl3yTCqB8PTS+ARrf
EI1vhMY3RuOboPFN4XwAR2FfjA==
      "]]}, 
    {RGBColor[0.560181, 0.691569, 0.194885], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQEf7CtfqhlyKNQ7QAUcmH0f7u7tLoPyORwUfD82
PJYugPIFHOzzfj7QX5cG5Ys4fOVN3nwwKx7Kl3BY8tVr4qz4UChfxsFNZfWx
L00+UL6Cg3lDQETYLCcoX8mhfOaP+e7rzaF8FYct5wsqzwTrQvlqDvvrLz2Q
na4I5Ws4tPP6S58IF4HytRxqrnGvk+1ig/J1HKZl5Lun7/puD+HrOfzpZi2J
L3sO5Rs4lP4/57o/5yqUb+ggzRF3bs3Ug1C+kUOAcFD/oi0roHxjh3X12gKC
67ugfBOHPys/XvJNKoDyTeF8AFcmWQ4=
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 21.}, {0, 314.164181385834}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8631123193793297`*^9, 3.8631123262043576`*^9}, {
   3.8631123786992965`*^9, 3.863112382514135*^9}, 3.863112478079895*^9, {
   3.8631145094396667`*^9, 3.8631145580864925`*^9}, 3.8631145892323303`*^9, {
   3.8631158576435876`*^9, 3.863115888610879*^9}, {3.863202926770657*^9, 
   3.8632030632000113`*^9}, {3.8632033153910594`*^9, 3.8632033970552807`*^9}, 
   3.8632034453106537`*^9, {3.863203483553603*^9, 3.8632035398327484`*^9}, {
   3.8632036900673504`*^9, 3.8632038653469496`*^9}},
 CellLabel->
  "Out[394]=",ExpressionUUID->"469fb085-9c2c-48ac-9aba-ad1864643020"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "^", "3"}], "-", "1"}], ")"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "layers"}], "+", "1"}], ")"}], "*", "delayFactor"}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "1", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.863111939972403*^9, 3.863111974203205*^9}, {
  3.863112023422864*^9, 3.8631120718836927`*^9}, {3.8631121826159544`*^9, 
  3.8631122235370193`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"1c60a498-27b8-46db-b307-d91222d20b2a"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVjHs0VAkAh8drxvtxL6FC8j5LlGZbpu3+WEXC8Txj5c5uarQ95FXpHHqw
htHmkaxjU1JtSvZQUemk3NKGFGUUatsKeRYjjNdo1v7xne+f73yWUbHBQmUW
i+W/yP9uZ4aMWCwpVSSwfKdQcJiT7H+S2GpSamFdz+fEGQ4T6Nfara0ppWbN
7KheKYdp7bxx1tRQSlWm+V6s/sBhmkeTbVztpVS7JMxnWQOHYZbrcqMDpZTu
3dhaVRGHqTy0JvRpqZSybnVr4qpxmCyX5Pwij3FKOTsu6p5MjXH8ZtJoQ8kX
aleLV5+tUIXppfJGmnonKHuMzDScZzFbCnhz0pVT1KRrXSZlNl9fmtiqZ3tY
RuXba/r75E/Uq8ekJ4GZptZ7jtyoDhmop8ct+3eaz1JxwsKBz3eY+h03W7Md
D85R+rXT1MMH76kjp0oyX92ap95ftaPLbScokTxMnE0sUCe0Hoz7yxXUuaMu
bxz4X6kei+qNvSfY2OO5dOf23xWU/GNxQIlYBwZNU/LQJBYeOoe+1PlAYHo+
dmy3iRIKXqcEB6sbI2SKFnIalXBha8az6r5lEOdIkhISlLHhcnHUXtEKNNZE
uAYSKvCib+g8MrFCSmlYQk29CtKGs8qjltiCZxoV8ds2VZzIsolVIhwQx+/5
e1BfDYHzt6PL0x1xhDv8zPCeGlKcM2aS9F1QWKpytJpmw+WU1NTp9WpYv8ir
7tLiIDA7y2zLoCvqcpxPxlVycMnPze0nKRdOn8K0Ov3VkZf5IUZH8zsY6knV
H82pQ6LbPRQe7w61+uIqqzMa+Bqt+yWydT32rr3brbFFE6vM23UKj1H4a3NU
6X2ZJti/DEcr23hANrJUv79QCxsbNliZp3niVoi3SoGXNt7UNcrZel445iM6
V9OvDWEb0WF1aiNWvvXtuijSwQ7V5JHkFd7grUsvMF2jCxOnRLGsxwe0edus
kkQXAQHugS1/+EL2JLsnLlUPQvNLYvvjfvBTdnZ3IPRxvGXSPTEmAJpjEUFK
UfrIQbHHMqdA/HofV8/U6sP3MM/P8YcgpIZW8eM1DGB58NoF7aBguD/r3KSx
zQCH3cq4qqkheGfkla5+2wAD2omHgm6HQsPGbYkHh0C59CSvsDcMo0sGh9YL
CDy2m+A7cfkIb7MgEqoIjMZk7+5IDkcVv1isqyDQkVlSqdz4Ix48fI59YSQm
BKdnWty3Inwyx59TRuLbotyI0vOReNzq6RJ7mYSczVNauByJteUyovMKCd6V
ibyIykjoCQRdZRUkHju37TG5u9g3Om3fdJ1EDaFscK4jEtzip4dEdSTMrT/b
dXFoEJ6af6pISETzxfLZfTSOLb+fsaeDxLXVth8TD9AYlcXvkrwkcb6iv3Y0
mUZzRfeqi10kLByJlQPixd6o/I7nvySsLfrlPRdojA16t6UOkchtNu5ld9KI
bJi/PjRMomm6SpT7lsaTs1UFQZ9IeKccMDTto1EWbBxhOUaigtsiWzVOQ1DX
38dMkshz2P9cqCXA08LTjfYyEvzmza+mDARwjw+4mjdN4srS9qYMEwGMbG/F
/jxHIv/o9/srbARIY+0ObponMT/k4UQ5CiB9bcZ1WSBxuponkawRQHDzhXHR
VxIvM3nRu9wW/7miOYWCBEkE9ysoAf4D8fcpkQ==
       "]]},
     Annotation[#, "Charting`Private`Tag$17172#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{1.0000000000000022`, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{1, 5}, {-2.9999997551020208`, 120.99999387755115`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8631119456226025`*^9, 3.8631119746159496`*^9}, {
  3.86311203088595*^9, 3.8631120721835794`*^9}, {3.8631121835682445`*^9, 
  3.863112223990822*^9}},
 CellLabel->"Out[42]=",ExpressionUUID->"c7303cf3-8c35-4b11-a331-b4112a3a0647"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", "x", "]"}], "-", "1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "layers"}], "+", "1"}], ")"}], "*", "delayFactor"}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8631117398392735`*^9, 3.863111747831775*^9}, {
  3.8631118170737123`*^9, 3.863111817411273*^9}, {3.8631118980241165`*^9, 
  3.863111898100439*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"0027c244-cc20-4b8b-bfd7-6679f175ddbc"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVjn8403kcwDfDmCnzLZeEcZ5o+dVT56GTzzu6hws9Can1qH2nIT+bSKFL
InmiW3KSkkPlevKjuhWq276hhJkTCZM8Zik1F1pt5uy6P17P63n997LjJu/i
6ZFIpOBv/O+KX7iGGw5m+vCngud0OirR3s8MimDuRRkFzhGyRSqheyY6zWQe
QnVh/5y8r6ESFUSRrQHzOApKcbeKnqcSCVvSEr/aFiC9BF1c81sq0a+NLflk
exm5bXPQs+uhElTZhKPS9hYyXblUulRGJaq6KvkfbFvQyLUOtdSZSjQ0FsgS
XLvQUd8RlqubIRGD+i5/TOlHRif2b2tyMiCSFOvkwoZh1Mijq3vo+gTNLtfx
jec4KsGe7VE06RHnzbpZVRw5skRB6YURZIIrCxNTJG/REqla0cTRiflPc7nJ
jtNIuvfTzEK7Vnz3MD101c9KNDBobM83UYurMuOn3SM+IWemuzayeF6cU7kY
8vnjLDJL8aj9IFeKSf3j8DhjHmULNq+Jn5CL16ZGHwtjqRDJK9c+KrNXPKm6
tNvkry+IGZLceXVdK9quiDtRzFejgInA1B9T5GjHpGC9jc0CGo0VrG4emUXT
bdzs5/Va9Nw4t5Xvs4BcGYPWfgf+RTm+2RFNTnpAQyp8dH4JWaxK4Y9FUsFf
yf5qH04Cz149hW2lKQy1HiSznclwZ1OWV6GXOdw/276fqSLDTO36oSXxSog2
SBuXSvVgzO0P4ROtJUSlZN6nl1NghPewzDzSBtxi1kuDcH1Qnr7aqCy0g15z
Z5M0LwMYP/63isZzgEcNOVecKYbQSl4RcSTcETLJrJ2S14ZgUZEYa/2aBbTR
jIAkIRW6JovKUZMrKG7alVRmGcEQ7ablqT0boMTJUr8l3BhUd273lT7aCILy
6A6cSQOJz+81hRs9gF0SKaVP0SBZbX2hf8wT1NtuaCpFJnBUZdzggXmDXOF7
rDWfDkbi4fgLXATVWzZY9eCm8K7lusvqhq1Qn5fGiHFZBuW1Ha+Ej/0gPzwq
kKJaBisOF6+O+vIT/DBadSu/Zzl8Fe0b4lcHQNm6K/U9gWZwMa5UeJYXCCeJ
orLAFjMIO/M+oOfBDgi2Cr/R5cAA82lL2gQrBLYmdexjFDAgKHfK6IBxKFSu
4TpIVAw4JxM5aP3DwaGttnTHPnNILK2j8sojQODSynoh+tZVh/w9rNkQPa/f
18nC4FrnDJluFwncu3PMgl8x2Jg+kO9jy4GEnNDF7RcwWOaUlVe0lgNpocJX
9IsYDJpKWt64cOCsKu28oBQD3ZyJpMibAw1eGu2lCgyq9rSJzNgc0DzRDd68
jcE72as1f/7GAcELelF7BwbdiYayI8txKK9JjD3TiYE5u+mo83c41KRK/QK6
MdAMZ6e/s8HhgYVgoVuKwdanuxviXHEYZWOx/S8xGE2iWJUF4+Aot/SbkGNQ
fWaTb1khDu7CDJvrCgyG/UmT+SU4bM6TaXhTGPR8b0HJvIpDkGPFnffTGFBm
/MTxdTikxDNtZmcxaJ7rYKdLcMjyPqW5N//tV6tjnB7AIc90YiBVhYHSR7ar
eBSHssaac2o1Bm0zwvRHH3GoztaPebiAwb3evv0vP+NwO4Tnm7WIwc5+6cu5
RRyE9s+sfZYwWP7Bewwz4IJofq1Gp8Ogrrn+uKcpF/4DDDk/DQ==
       "]]},
     Annotation[#, "Charting`Private`Tag$11045#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 5}, {-2.9999998979591784`, 144.41314395837742`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.863111748403134*^9, 3.863111818010413*^9, 
  3.8631118989587994`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"f62d0348-7922-43fa-aca3-3467af593365"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgMin", "[", 
  RowBox[{"3", ",", "1", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.8631136246224422`*^9, 3.8631136376910934`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"8a12fda1-d902-49be-912d-90ef98cef659"],

Cell[BoxData[
 TemplateBox[{
  "ArgMin", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"2\\\"}]\\) is not a valid variable.\"", 2, 62, 2, 
   32055821776949346368, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.863113631445839*^9, 3.8631136381017623`*^9}},
 CellLabel->
  "During evaluation of \
In[62]:=",ExpressionUUID->"93b28f44-24d0-4931-a348-3126c5808a6b"],

Cell[BoxData[
 RowBox[{"ArgMin", "[", 
  RowBox[{"3", ",", "1", ",", "2"}], "]"}]], "Output",
 CellChangeTimes->{{3.8631136314702773`*^9, 3.8631136381487265`*^9}},
 CellLabel->"Out[62]=",ExpressionUUID->"098788f5-7655-4418-97a1-c2941e5c0493"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ordering", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "4"}], "}"}], ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8631139116135345`*^9, 3.8631139211382313`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"ba4c4de3-accf-47fb-8993-b0d7a8a62ef4"],

Cell[BoxData[
 RowBox[{"{", "2", "}"}]], "Output",
 CellChangeTimes->{{3.8631139191012893`*^9, 3.863113921769511*^9}},
 CellLabel->"Out[64]=",ExpressionUUID->"f821ba0b-bbd2-4bb6-b289-72e4661c57d1"]
}, Open  ]]
},
WindowSize->{951., 523.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"834c3e8f-d41d-41b9-b946-eca65ff5d1f2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 243, 6, 28, "Input",ExpressionUUID->"0bce0b81-aab1-4f44-8f72-78f0e03b3e8d"],
Cell[CellGroupData[{
Cell[826, 30, 35015, 999, 3301, "Input",ExpressionUUID->"6493608d-0719-4be6-8d20-602c1b1f26c1"],
Cell[35844, 1031, 436, 10, 28, "Message",ExpressionUUID->"1c8d1a0a-87bd-4ff0-b602-af4d4cb82d00"],
Cell[CellGroupData[{
Cell[36305, 1045, 311, 6, 22, "Print",ExpressionUUID->"de64f420-9591-4658-b3a6-aa4caa0eb078"],
Cell[36619, 1053, 244, 5, 22, "Print",ExpressionUUID->"7366fc52-5131-4114-885c-a044d332b44b"],
Cell[36866, 1060, 280, 5, 22, "Print",ExpressionUUID->"510b2535-e861-495b-8345-efff974bdaad"],
Cell[37149, 1067, 229, 5, 22, "Print",ExpressionUUID->"f7122417-5f34-4492-9e6f-de7110f08f5f"],
Cell[37381, 1074, 242, 5, 22, "Print",ExpressionUUID->"7c5be66d-2f65-46a4-b5b7-407227a33d8c"],
Cell[37626, 1081, 483, 13, 22, "Print",ExpressionUUID->"3e6d945a-29be-498f-9961-2b6ecf5c0d3c"],
Cell[38112, 1096, 286, 7, 22, "Print",ExpressionUUID->"852953a0-c7b0-4d3f-9e48-b482af71088b"],
Cell[38401, 1105, 257, 5, 22, "Print",ExpressionUUID->"3c652846-c0b9-4e9b-931f-118c1e03c182"],
Cell[38661, 1112, 424, 10, 22, "Print",ExpressionUUID->"0e83e33b-575d-4a7a-b088-d8b9134e07c2"],
Cell[39088, 1124, 390, 9, 22, "Print",ExpressionUUID->"89d13910-6ba0-40f3-b4c3-72244bf25240"],
Cell[39481, 1135, 389, 9, 22, "Print",ExpressionUUID->"2c3fb6de-9cfe-4431-ab36-e237d439a9a4"],
Cell[39873, 1146, 393, 10, 22, "Print",ExpressionUUID->"4bdc58cc-ae97-4a16-9f78-8e25282c2c9c"],
Cell[40269, 1158, 406, 10, 22, "Print",ExpressionUUID->"b56758ff-275a-4ed3-96f8-b70b5a90ff9b"],
Cell[40678, 1170, 402, 9, 22, "Print",ExpressionUUID->"01b07f0b-a017-4efd-addf-d447781057d2"],
Cell[41083, 1181, 401, 9, 22, "Print",ExpressionUUID->"c141f746-5022-42d5-bc59-e587dbce31cb"],
Cell[41487, 1192, 370, 9, 22, "Print",ExpressionUUID->"3352b49c-46a1-4bc2-95b5-ce38020d0a0e"],
Cell[41860, 1203, 403, 10, 22, "Print",ExpressionUUID->"21581f09-988b-4fee-b44e-275687582d1d"],
Cell[42266, 1215, 401, 9, 22, "Print",ExpressionUUID->"2b8486aa-825f-47c4-b293-7b312526e922"],
Cell[42670, 1226, 403, 10, 22, "Print",ExpressionUUID->"b95510c0-ab41-40c0-9305-10569bb1848a"],
Cell[43076, 1238, 403, 10, 22, "Print",ExpressionUUID->"fac15209-f666-40ac-aba0-5a9da9fc38d1"],
Cell[43482, 1250, 401, 9, 22, "Print",ExpressionUUID->"7d08aba0-af13-4cce-866e-ca703bbc1ffd"],
Cell[43886, 1261, 401, 9, 22, "Print",ExpressionUUID->"0a953201-ca18-469f-8822-9f8eff033874"],
Cell[44290, 1272, 401, 9, 22, "Print",ExpressionUUID->"6ac82c60-0391-4554-b28f-c3b730ca7f5e"],
Cell[44694, 1283, 370, 9, 22, "Print",ExpressionUUID->"0c571b5a-a45e-4942-99ea-e1bbfe9be722"],
Cell[45067, 1294, 401, 9, 22, "Print",ExpressionUUID->"60ada4b6-f786-4058-ae5f-c21816367215"],
Cell[45471, 1305, 369, 9, 22, "Print",ExpressionUUID->"2e9a164f-74f9-4212-a43b-36abff8ccbc6"],
Cell[45843, 1316, 400, 9, 22, "Print",ExpressionUUID->"7fb8783c-e6a8-4ce7-b471-d855b88646ae"],
Cell[46246, 1327, 372, 9, 22, "Print",ExpressionUUID->"03a0ee3a-2456-4f5c-ae7d-c0711ad6505a"],
Cell[46621, 1338, 248, 5, 22, "Print",ExpressionUUID->"62a86988-9ddd-4fa6-ae7f-f0fe2bc15ffb"],
Cell[46872, 1345, 248, 5, 22, "Print",ExpressionUUID->"f194fda0-df3b-4835-880b-b76306a56d84"],
Cell[47123, 1352, 248, 5, 22, "Print",ExpressionUUID->"37551f2f-ce9c-426c-8020-0e57f2056b2e"],
Cell[47374, 1359, 248, 5, 22, "Print",ExpressionUUID->"8a9695de-5287-4aa6-baa0-efd38b376364"],
Cell[47625, 1366, 244, 5, 22, "Print",ExpressionUUID->"e3fcb4f5-9b5b-4154-b65d-f630cd148862"],
Cell[47872, 1373, 245, 5, 22, "Print",ExpressionUUID->"bda59559-c4fa-4e59-8c5d-16791334c27a"],
Cell[48120, 1380, 245, 5, 22, "Print",ExpressionUUID->"92970498-9e1d-43a8-8b52-dc3b43dd8959"],
Cell[48368, 1387, 246, 5, 22, "Print",ExpressionUUID->"977c83d8-057f-4b5d-81e4-81379a39bd26"],
Cell[48617, 1394, 244, 5, 22, "Print",ExpressionUUID->"d1f06e67-f3bd-4519-9b32-6e4738470fa8"],
Cell[48864, 1401, 247, 5, 22, "Print",ExpressionUUID->"834a2548-8787-4e88-a9bf-a8db2a72aea0"],
Cell[49114, 1408, 248, 5, 22, "Print",ExpressionUUID->"96da6c08-28b1-4e1a-a9cc-c4c88f786f6d"],
Cell[49365, 1415, 247, 5, 22, "Print",ExpressionUUID->"dfd221bb-fbfb-4164-9f79-df5bb83bab46"],
Cell[49615, 1422, 247, 5, 22, "Print",ExpressionUUID->"3d3bf63c-cec6-435b-9c13-64a58cf9d694"],
Cell[49865, 1429, 247, 5, 22, "Print",ExpressionUUID->"f67a5b8f-411b-41c3-947d-ea2b4ee0f0e5"],
Cell[50115, 1436, 247, 5, 22, "Print",ExpressionUUID->"f51cabd1-57ac-48b6-9b77-9c32f3a50948"],
Cell[50365, 1443, 247, 5, 22, "Print",ExpressionUUID->"8ab05c87-670f-4d19-8270-931571df71dd"],
Cell[50615, 1450, 247, 5, 22, "Print",ExpressionUUID->"4f416bd7-6b9b-4df8-abb1-741b50f80fcf"],
Cell[50865, 1457, 247, 5, 22, "Print",ExpressionUUID->"5091f19b-a2ee-492d-ac41-a6b1d27ba35d"],
Cell[51115, 1464, 247, 5, 22, "Print",ExpressionUUID->"4f041dfc-f586-4f8c-8577-2f4bdc2a078b"],
Cell[51365, 1471, 247, 5, 22, "Print",ExpressionUUID->"621fa5c0-f0ec-442f-8791-5a0a689b26f9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51661, 1482, 4627, 118, 314, "Input",ExpressionUUID->"5a36e93a-f416-42cd-8255-0b873ffc9035"],
Cell[56291, 1602, 3665, 91, 147, "Output",ExpressionUUID->"4f088692-22e5-4d6c-9e8a-3a9a81607445"]
}, Open  ]],
Cell[59971, 1696, 767, 14, 86, "Input",ExpressionUUID->"82bc45dc-7ccb-4f68-a82a-aa50d8ba7faa"],
Cell[CellGroupData[{
Cell[60763, 1714, 1598, 43, 124, "Input",ExpressionUUID->"7afdaa10-235c-443c-814e-689d86867b16"],
Cell[62364, 1759, 973, 19, 52, "Output",ExpressionUUID->"e48be8b9-b32f-434c-826b-ee7e18f945ad"],
Cell[63340, 1780, 11948, 217, 242, "Output",ExpressionUUID->"ec4aa597-3af5-4c43-bfa2-2bd391526196"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75325, 2002, 1092, 28, 105, "Input",ExpressionUUID->"8a0c39aa-a480-4893-8c7f-42ab459a4614"],
Cell[76420, 2032, 475, 9, 32, "Output",ExpressionUUID->"ae88e1cc-a6c5-4ce1-a063-829396d26ce2"],
Cell[76898, 2043, 1502, 39, 232, "Output",ExpressionUUID->"c8a4a856-3db4-488b-ae76-828d87c0f345"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78437, 2087, 515, 14, 28, "Input",ExpressionUUID->"1476f101-ead2-4862-acef-1b89af42b39a"],
Cell[78955, 2103, 242, 3, 32, "Output",ExpressionUUID->"38c3a15e-52ff-4c25-ab82-4fa456aaaef6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79234, 2111, 383, 11, 28, "Input",ExpressionUUID->"c64275ac-c231-48af-9b5d-35592b8e51d9"],
Cell[79620, 2124, 228, 3, 32, "Output",ExpressionUUID->"ee665eda-2254-4b2d-82c4-6764c82ceb40"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79885, 2132, 4186, 111, 333, "Input",ExpressionUUID->"952e5e94-246d-4862-891c-1f49ebc8ae4e"],
Cell[84074, 2245, 1395, 26, 52, "Output",ExpressionUUID->"605387a4-2633-4b7e-8621-0f4f2edfe796"],
Cell[85472, 2273, 2365, 42, 179, "Output",ExpressionUUID->"61e1fd86-1417-4026-9732-a51a4cc4082f"],
Cell[87840, 2317, 2900, 65, 241, "Output",ExpressionUUID->"469fb085-9c2c-48ac-9aba-ad1864643020"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90777, 2387, 610, 17, 28, "Input",ExpressionUUID->"1c60a498-27b8-46db-b307-d91222d20b2a"],
Cell[91390, 2406, 3594, 77, 232, "Output",ExpressionUUID->"c7303cf3-8c35-4b11-a331-b4112a3a0647"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95021, 2488, 574, 15, 28, "Input",ExpressionUUID->"0027c244-cc20-4b8b-bfd7-6679f175ddbc"],
Cell[95598, 2505, 3508, 76, 233, "Output",ExpressionUUID->"f62d0348-7922-43fa-aca3-3467af593365"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99143, 2586, 241, 4, 28, "Input",ExpressionUUID->"8a12fda1-d902-49be-912d-90ef98cef659"],
Cell[99387, 2592, 376, 9, 28, "Message",ExpressionUUID->"93b28f44-24d0-4931-a348-3126c5808a6b"],
Cell[99766, 2603, 242, 4, 32, "Output",ExpressionUUID->"098788f5-7655-4418-97a1-c2941e5c0493"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100045, 2612, 305, 7, 28, "Input",ExpressionUUID->"ba4c4de3-accf-47fb-8993-b0d7a8a62ef4"],
Cell[100353, 2621, 197, 3, 32, "Output",ExpressionUUID->"f821ba0b-bbd2-4bb6-b289-72e4661c57d1"]
}, Open  ]]
}
]
*)

